vector = c(10, 40, 78, 64, 53, 62, 69, 70)
vector[1,2,3]
print(vectorp[1,2,3])
print(vector[1,2,3])
print(vector[1])
print(vector[which(vector>40)])
nchar("Google Runoob Taobao")
library(shiny); runApp('D:/document/monash/Year2S1/fit5147/assignment/a2/test/test.r')
install.packages("igraph")
library(igraph)
g <- graph.formula(1-2, 1-3, 2-3, 2-4)
plot(g)
V(g)
E(g)
diameter(g)
get.adjacency(g)
V(g)$name <- c("a","b","c","d")
plot(g,vertex.label = V(g)$name)
get.adjacency()
get.adjacency(g)
dg <- graph.formula(1-+2, 1-+3, 2-+3, 2-+4)
plot(dg)
dg <- graph.formula(1++2, 1-+3, 2-+3, 2-+4)
plot(dg)
is.weighted(dg)
E(dg)$weights <- runif(ecount(wdg)) * 1000
E(dg)$weights <- runif(ecount(dg)) * 1000
plot(dg, vertex.label = V(dg)$name, edge.width=E(dg)$weights)
V(dg)$name <- c("a","b","c","d")
plot(dg, vertex.label = V(dg)$name, edge.width=E(dg)$weights)
E(dg)$weights <- runif(ecount(dg)) * 1000
plot(dg, vertex.label = V(dg)$name, edge.width=E(dg)$weights)
plot(dg, vertex.label = V(dg)$name, edge.width=E(dg)$weights/100)
wdg <-dg
plot(wdg, vertex.label = V(wdg)$name, edge.width=E(wdg)$weights / 100, layout = layout.star)
G <- graph( c(1,2,1,3,1,4,3,4,3,5,5,6,6,7,7,8,8,9,3,8,5,8), directed = F )
plot(G)
G$name <- "Change my layout, I dare you"
V(G)$name  <- toupper(letters[1:9])
V(G)$color <- sample(rainbow(9),9,replace=FALSE)
E(G)$weight <- runif(length(E(G)),.5,4)
plot(G, layout = layout.auto,
main = G$name,
vertex.label = V(G)$name,
vertex.size = 25,
vertex.color= V(G)$color,
vertex.frame.color= "white",
vertex.label.color = "white",
vertex.label.family = "sans",
edge.width=E(G)$weight,
edge.color="black")
par(mfrow=c(2,2)) # 2 x 2 display
g <- graph.full(n=5, directed = FALSE, loops = FALSE)
plot(g)
g <- graph.star(n=5, mode="out")
plot(g)
g <- graph.star(n=5, mode="in")
plot(g)
g = graph.ring(n=5)
plot(g)
par(mfrow=c(1,1))
g <- graph.full(5)
E(g)$weight <- runif(ecount(g)) # random weights, run again for different result
E(g)$width <- 1
E(g)$color <- "red"
E(g)[ weight < 0.5 ]$width <- 2
E(g)[ weight < 0.5 ]$color <- "blue"
plot(g, layout=layout.circle, edge.width=E(g)$width, edge.color= E(g)$color)
E(g)$weight
g1 <- make_star(5)
g2 <- induced_subgraph(g1, 1:2) # select vertices
g3 <- subgraph.edges(g1, 1:3, TRUE) # select edges
par(mfrow=c(1,3))
plot(g1)
plot(g2)
plot(g3)
library(igraphdata)
library(dplyr)
library(corrplot)
library(visdat)
library(inspectdf)
library(fmsb)
library(ggmap)
library(tidytext)
library(tm)
library(stringr)
library(wordcloud)
library(RColorBrewer)
library(textdata)
library(ggplot2)
setwd("d:/document/monash/Year2S1/fit5147/assignment/data")
#q3 data wrangle
q3.vote <- read.csv("president_county_candidate.csv")
summary(q3.vote)
glimpse(q3.vote)
q3.vote.biden <- q3.vote %>% filter(candidate == 'Joe Biden')%>% select(state, total_votes) %>% group_by(state)  %>% summarise(biden_total = sum(total_votes))
q3.vote.biden
q3.vote.trump <- q3.vote %>% filter(candidate == 'Donald Trump')%>% select(state, total_votes) %>% group_by(state)  %>% summarise(trump_total = sum(total_votes))
q3.vote.trump
q1.location_source = read.csv("q1_location_source.csv")
#state analysis in r
q1.state <- filter(q1.location_source, country == 'United States', !is.na(state))
q1.state <- select(q1.state, lat, long, state, candidate)
q1.state.count <- q1.state %>%  select(candidate, state) %>%
group_by(state, candidate) %>%
summarise(sum = n())
q3.state.count <- q1.state.count
q3.state.biden <- q3.state.count %>% filter(candidate == 'Biden')%>% select(state, sum_biden = sum)
q3.state.biden
q3.state.trump <- q3.state.count %>% filter(candidate == 'Trump')%>% select(state, sum_trump = sum)
q3.state.trump
q3.trump <- q3.state.trump %>% inner_join(q3.vote.trump, by = 'state')
q3.trump
q3.biden <- q3.state.biden %>% inner_join(q3.vote.biden, by = 'state')
q3.biden
write.csv(x = q3.trump, file = "q3_combine_trump.csv", row.names = FALSE)
write.csv(x = q3.biden, file = "q3_combine_biden.csv", row.names = FALSE)
q1.state.count.trump <- q1.state.count %>% filter(candidate == 'Trump') %>%
arrange(desc(sum))
q1.state.count.trump<-q1.state.count.trump[1:30,]
q1.state.count.trump$id <- seq(1, nrow(q1.state.count.trump))
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm")
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))+
ggtitle("Number of Trump related tweets in Top 30 states")
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm"),
plot.title = element_text(hjust = 0.5)
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))+
ggtitle("Number of Trump related tweets in Top 30 states")
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm"),
plot.title = element_text(hjust = 0.5, vjust = -6)
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))+
ggtitle("Number of Trump related tweets in Top 30 states")
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm"),
plot.title = element_text(hjust = 0.5, vjust = -8)
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))+
ggtitle("Number of Trump related tweets in Top 30 states")
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm"),
plot.title = element_text(hjust = 0.5, vjust = -15)
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))+
ggtitle("Number of Trump related tweets in Top 30 states")
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm"),
plot.title = element_text(hjust = 0.5, vjust = -13)
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))+
ggtitle("Number of Trump related tweets in Top 30 states")
ggplot(q1.state.count.trump, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("orange", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm"),
plot.title = element_text(hjust = 0.5, vjust = -20)
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.trump, aes(x = id, y = sum, label = state))+
ggtitle("Number of Trump related tweets in Top 30 states")
q1.state.count.biden <- q1.state.count %>% filter(candidate == 'Biden') %>%
arrange(desc(sum))
q1.state.count.biden<-q1.state.count.biden[1:30,]
q1.state.count.biden$id <- seq(1, nrow(q1.state.count.biden))
ggplot(q1.state.count.biden, aes(x = as.factor(id), y = sum)) +
geom_bar(stat = "identity", fill = alpha("blue", 0.3)) +
ylim(-25000, 32000) +
theme_minimal() +
theme(
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-1,4), "cm"),
plot.title = element_text(hjust = 0.5, vjust = -20)
)+
coord_polar(start = 0)+
geom_text(data = q1.state.count.biden, aes(x = id, y = sum, label = state))+
ggtitle("Number of Biden related tweets in Top 30 states")
q2.sentiment2 = read.csv("q2_sentiment2.csv")
q2.sentiment2 <- q2.sentiment2 %>% group_by(id, likes, retweet_count, candidate) %>%
summarise(sentiment_score = sum(value))
#a <- q2.sentiment2$sentiment_score
#a
#hist(a)
q2.sentiment2.trump <- q2.sentiment2 %>% filter(candidate == 'Trump' & sentiment_score > -50 & sentiment_score < 50)
q2.sentiment2.trump
q2.sentiment2.biden <- q2.sentiment2 %>% filter(candidate == 'Biden' & sentiment_score > -50 & sentiment_score < 50)
q2.sentiment2.trump
hist(q2.sentiment2.trump$sentiment_score, col = 'orange')
hist(q2.sentiment2.trump$sentiment_score, col = 'orange') +
ggtitle("Number of Trump related tweets in Top 30 states")
hist(q2.sentiment2.trump$sentiment_score, col = 'orange',
main = "Trump related tweets sentiment score distribution")
hist(q2.sentiment2.biden$sentiment_score, col = 'blue',
main = "Biden related tweets sentiment score distribution")
setwd("d:/document/monash/Year2S1/fit5147/assignment/a2/PE2RScript/30976316_Yue_Zhang")
shiny::runApp('D:/document/monash/Year2S1/fit5147/assignment/a2/PE2RScript/30976316_Yue_Zhang')
q3.trump
q3.state.trump
q3.vote.trump
#explore is there any correlation between votes and tweets
ggplot(q3.trump, aes(x = trump_total, y = sum_trump)) + geom_point(shape =1)
ggplot(q3.biden, aes(x = biden_total, y = sum_biden)) + geom_point(shape =1)
#explore is there any correlation between votes and tweets
ggplot(q3.trump, aes(x = trump_total, y = sum_trump)) + geom_point(shape =1)+ geom_smooth(method = lm)
#explore is there any correlation between votes and tweets
ggplot(q3.trump, aes(x = trump_total, y = sum_trump)) + geom_point(shape =1)+ geom_smooth()
ggplot(q3.biden, aes(x = biden_total, y = sum_biden)) + geom_point(shape =1)
q3.trump
q3.trump.standard <- q3.trump %>% mutate(vote = sum_trump/sum(q3.trump$sum_trump))
q3.trump.standard
q3.trump.standard <- q3.trump %>% mutate(vote = sum_trump/sum(q3.trump$sum_trump)) %>% mutate(tweet = trump_total/sum(q3.trump$trump_total))
q3.trump.standard
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth()
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth(method = lm)
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth()
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth(method = lm)
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth()
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth(method = "loess")
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth(method = "lgam")
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth(method = "gam")
q3.biden.standard <- q3.biden %>% mutate(vote = sum_biden/sum(q3.biden$sum_biden)) %>% mutate(tweet = biden_total/sum(q3.biden$biden_total))
ggplot(q3.biden.standard, aes(x = vote, y = tweet)) + geom_point(shape =1)+ geom_smooth(method = "gam")
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")
ggplot(q3.biden.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")
ggplot(q3.biden.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")+
ggtitle("Correlation between Trump related tweets and real votes by each state")+
theme_minimal()
ggplot(q3.biden.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")+
ggtitle("Correlation between Biden related tweets and real votes by each state")+
theme_minimal()
#explore is there any correlation between votes and tweets
ggplot(q3.trump.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")+
ggtitle("Correlation between Trump related tweets and real votes by each state")+
theme_minimal()
ggplot(q3.biden.standard, aes(x = tweet, y = vote)) +
geom_point(shape =1)+
geom_smooth(method = "gam")+
ggtitle("Correlation between Biden related tweets and real votes by each state")+
theme_minimal()
q3.trump.standard
q3.biden.standard <- q3.biden %>% mutate(vote = sum_biden/sum(q3.biden$sum_biden)) %>% mutate(tweet = biden_total/sum(q3.biden$biden_total))
q3.biden.standard
